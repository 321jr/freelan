From 5014a8023b42762052d6417ebbc0cd2adb1fda90 Mon Sep 17 00:00:00 2001
From: Sebastien Vincent <sebastien.vincent@cppextrem.com>
Date: Sat, 5 Aug 2017 20:10:55 +0200
Subject: [PATCH] Fixes compilation with g++-7.

---
 libs/asiotap/src/posix/posix_tap_adapter.cpp      | 2 ++
 libs/netlinkplus/include/netlinkplus/endpoint.hpp | 8 +++++---
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/libs/asiotap/src/posix/posix_tap_adapter.cpp b/libs/asiotap/src/posix/posix_tap_adapter.cpp
index 71377cee..cdd7abf3 100644
--- a/libs/asiotap/src/posix/posix_tap_adapter.cpp
+++ b/libs/asiotap/src/posix/posix_tap_adapter.cpp
@@ -206,6 +206,7 @@ namespace asiotap
 						{
 							result[name] = name;
 						}
+						break;
 					}
 					case tap_adapter_layer::ip:
 					{
@@ -213,6 +214,7 @@ namespace asiotap
 						{
 							result[name] = name;
 						}
+						break;
 					}
 				}
 			}
diff --git a/libs/netlinkplus/include/netlinkplus/endpoint.hpp b/libs/netlinkplus/include/netlinkplus/endpoint.hpp
index 3503cae3..74fb7e1b 100644
--- a/libs/netlinkplus/include/netlinkplus/endpoint.hpp
+++ b/libs/netlinkplus/include/netlinkplus/endpoint.hpp
@@ -44,6 +44,8 @@
 
 #pragma once
 
+#include <cstring>
+
 #include <boost/asio.hpp>
 
 #include <linux/netlink.h>
@@ -125,17 +127,17 @@ namespace netlinkplus
 
 			friend bool operator==(const netlink_endpoint& lhs, const netlink_endpoint& rhs)
 			{
-				return (lhs.m_sockaddr == rhs.m_sockaddr);
+				return (std::memcmp(&lhs.m_sockaddr, &rhs.m_sockaddr, sizeof(sockaddr_nl)) == 0);
 			}
 
 			friend bool operator!=(const netlink_endpoint& lhs, const netlink_endpoint& rhs)
 			{
-				return (lhs.m_sockaddr != rhs.m_sockaddr);
+				return (std::memcmp(&lhs.m_sockaddr, &rhs.m_sockaddr, sizeof(sockaddr_nl)) != 0);
 			}
 
 			friend bool operator<(const netlink_endpoint& lhs, const netlink_endpoint& rhs)
 			{
-				return (lhs.m_sockaddr < rhs.m_sockaddr);
+				return (std::memcmp(&lhs.m_sockaddr, &rhs.m_sockaddr, sizeof(sockaddr_nl)) < 0);
 			}
 
 		private:
